<style>
canvas{
  background-color: #020731;
  padding-left: 0;
  padding-right: 0;
  margin-left: auto;
  margin-right: auto;
  display: block;
  border:1px solid #000000;
  /*width: 700px;*/
}

</style>


<canvas id="myCanvas" width="700" height="600"></canvas>
<script src ="jquery.min.js"></script>
<script>
var ctx = document.getElementById("myCanvas").getContext("2d");

ctx.font = "30px Arial";

// height and width of the window
var HEIGHT = 600;
var WIDTH = 700;

//timer
var timeBegin = Date.now();

// starting point of the zombies on the x axis
var x_zombie_1 = 100;
var x_zombie_2 = 200;
var x_zombie_3 = 300;
var x_zombie_4 = 400;
var x_zombie_5 = 500;
var x_zombie_6 = 600;

// starting point of each zombie on the y axis
var y_zombie_1 = 0;
var y_zombie_2 = 0;
var y_zombie_3 = 0;
var y_zombie_4 = 0;
var y_zombie_5 = 0;
var y_zombie_6 = 0;

//different speeds
var spdY_slow = 9
var spdY_medium = 15
var spdY_fast = 20
//ctx.fillText("Z",x,y)

//empty list of zombies
var zombieList = []

//Create objects of zombies
//Z1
Zombie("Z1", 100, 0,spdY_slow,30,30,"grey")
Zombie("Z1.1", 100, -200,spdY_slow,30,30,"grey")
Zombie("Z1.2", 100, -400,spdY_slow,30,30,"grey")
Zombie("Z1.3", 100, -600,spdY_slow,30,30,"grey")
//Z2
Zombie("Z2", 200, 0,spdY_slow,30,30,"grey")
Zombie("Z2.1", 200, -200,spdY_slow,30,30,"grey")
Zombie("Z2.2", 200, -400,spdY_slow,30,30,"grey")
Zombie("Z2.3", 200, -600,spdY_slow,30,30,"grey")
//Z3
Zombie("Z3", 300, 0,spdY_fast,30,30,"black")
//Z4
Zombie("Z4", 400, 0,spdY_slow,30,30,"grey")
//Z4
Zombie("Z5", 500, 0,spdY_medium,30,30,"red")
//Z5
Zombie("Z6", 600, 0,spdY_fast,30,30,"black")

//Player
var player = {
  x: 350,
  y: 550,
  name:"P",
  lives:"3",
  width:20,
  height:20,
  color: "white"
}


//get mouse position
document.onmousemove = function(mouse){
  var mouseX = mouse.clientX-document.getElementById("myCanvas").getBoundingClientRect().left;
  var mouseY = mouse.clientY- document.getElementById("myCanvas").getBoundingClientRect().top;
  if (mouseX < (player.width/2)){
    mouseX = (player.width/2)
  };
  if (mouseX > WIDTH-(player.width/2)){
    mouseX = WIDTH-(player.width/2)
  };
  if (mouseY < (player.height/2)){
    mouseY = (player.height/2)
  };
  if (mouseY > HEIGHT-(player.height/2)){
    mouseY = HEIGHT-(player.height/2)
  };

  player.x = mouseX;
  player.y = mouseY;
}

//function to create objects of zombies to rest in list
function Zombie(id,x,y,spdY,width,height,color){
  var zombie = {
    x:x,
    y:y,
    spdY:spdY,
    name:"Z",
    id:id,
    width:width,
    height:height,
    color:color,
  }
  zombieList[id] = zombie;
}

//functions for calculating collition. 1. distnce. 2. collision
// function getDistanceBetweenEntity(yay1, yay2){ // return distance in numbers
//   var vx = yay1.x - yay2.x;
//   var vy = yay1.y - yay2.y;
//   return Math.sqrt(vx*vx*vy*vy);
// }

testCollision = function (yay1,yay2){
    var rect1 = {
    x: yay1.x-((yay1.width)/2),
    y: yay1.y-((yay1.height)/2),
    width: yay1.width,
    height: yay1.height,
  }
    var rect2 = {
      x:yay1.x-((yay2.width)/2),
      y: yay2.y-((yay2.height)/2),
      width:yay2.width,
      height:yay2.height,
    }
  return collisionRect(rect1,rect2);
}

// function testCollision(yay1, yay2){
//   var distance = getDistanceBetweenEntity(yay1,yay2);
//   return distance < 20;
// }


collisionRect= function(rect1,rect2){
  return (rect1.x < rect2.x + rect2.width &&
   rect1.x + rect1.width > rect2.x &&
   rect1.y < rect2.y + rect2.height &&
   rect1.height + rect1.y > rect2.y);
}

//function to draw
draw_something = function(something){
  ctx.save();
  ctx.fillStyle = something.color;
  ctx.fillRect(something.x-((something.width)/2), something.y-((something.width)/2),something.width,something.height);
  ctx.restore();
}

// functions for zombies
update_z = function(something){
  update_z_position(something);
  draw_something(something);
}

//function to update position
update_z_position = function (something) {
  something.y += something.spdY;
}

// SET INTERVAL


setInterval(update, 100);


//create a while loop
function update(){
  ctx.clearRect(0,0,WIDTH,HEIGHT);

  for (var key in zombieList){
    update_z(zombieList[key]);

    var isColliding = testCollision(player,zombieList[key]);
    if (isColliding) {
      console.log('colliding!');
      player.lives = player.lives - 1;
      if (player.lives <= 0){
        var timeSurvived = Date.now() - timeBegin;
        //alert("YOU HAVE BEEN INFECTED! You survived for "+timeSurvived +"ms");
      };
    }
  };
  draw_something(player);
  ctx.fillText(("player life:" + player.lives),500,550);

}

</script>